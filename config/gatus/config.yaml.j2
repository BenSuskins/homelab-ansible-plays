metrics: true

alerting:
  discord:
    webhook-url: "{{ GATUS_DISCORD_WEBHOOK | default('') }}"
    title: "Gatus"
    default-alert:
      description: "Health check failed"
      send-on-resolved: true
      failure-threshold: 3
      success-threshold: 2

ui:
  default-sort-by: group

endpoints:
{% for svc in monitored_services %}
{% if svc.healthcheck | default(false) %}
{% set path = (svc.healthcheck_path | default('')) %}
{% if path != '' and not path.startswith('/') %}{% set path = '/' ~ path %}{% endif %}
{% set url = svc.scheme ~ "://" ~ svc.ip ~ ":" ~ svc.port ~ path %}
  - name: {{ svc.name }}
    url: "{{ url }}"
    interval: 60s
    group: {{ svc.friendly_name }}
    conditions:
      - "[STATUS] == 200"
    alerts:
      - type: discord
{% if svc.scheme == 'https' %}      
    client:
      insecure: true
{% endif %}
{% endif %}
{% endfor %}

security:
  oidc:
    issuer-url: https://authentik.{{ domain }}/application/o/gatus/
    client-id: {{ GATUS_OIDC_CLIENT_ID }}
    client-secret: {{ GATUS_OIDC_CLIENT_SECRET }}
    redirect-url: https://gatus.{{ domain }}/authorization-code/callback
    scopes: [openid]
